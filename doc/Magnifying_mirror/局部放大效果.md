# æ•ˆæœæ¼”ç¤º

å¯¹ç”»é¢çš„æŸä¸ªä½ç½®è¿›è¡Œæ”¾å¤§å’Œç¼©å°ï¼Œæ˜¯æŸäº›ç±»å‹æ¸¸æˆé‡Œé¢å¿…ä¸å¯å°‘çš„åŠŸèƒ½ï¼Œæ¯”å¦‚å¸¸è§çš„åœ°å›¾ç¼©æ”¾ï¼Œå±€éƒ¨ç»†èŠ‚æ”¾å¤§ç­‰ç­‰ã€‚å®ƒæ ¸å¿ƒæ˜¯å¯¹ç›¸æœºåº”ç”¨ï¼Œå¼‚ååŸºäºæ­¤å®ç°ä¸€ä¸ªæ”¾å¤§é•œçš„demo

![demo](./resources/demo.gif)

# å®ç°æ€è·¯
é¦–å…ˆè¦ç†è§£ç›¸æœºï¼Œå’Œç°å®çš„ç›¸æœºä¸€æ ·ï¼Œç›¸æœºæ˜¯ç”¨æ¥æ‹æ‘„ç”»é¢çš„ï¼Œç„¶åç”Ÿæˆç…§ç‰‡ä¹Ÿå°±æ˜¯`Texture`ï¼Œä½†æ˜¯å¼•æ“å†…çš„ç›¸æœºç›¸å½“äºäººçœ¼ç›ï¼Œå®ƒæ¯ä¸€å¸§éƒ½åœ¨æ‹æ‘„ç”»é¢ï¼Œå¯èƒ½ä½ æ²¡ç”¨ç•™æ„åˆ°ï¼Œæˆ‘ä»¬åˆå§‹åŒ–çš„æ¯ä¸ªåœºæ™¯çš„canvasä¸‹éƒ½é»˜è®¤æœ‰ä¸€ä¸ª`Main Camera`ï¼Œå®ƒå°±æ˜¯ç”¨æ¥æ‹æ‘„æ•´ä¸ªåœºæ™¯çš„å†…å®¹ï¼Œç„¶åæŠ•å½±åˆ°ç”»å¸ƒä¸Šçš„ã€‚å¼‚åç¿»äº†ä¸€ä¸‹ä»¥å‰è‡ªå·±æ¥è§¦`Camera`è¿™ä¸ªæ¦‚å¿µçš„æ—¶å€™çš„ç¬”è®°ï¼Œåœ¨è¿™é‡Œè´´ä¸€ä¸‹ï¼š

> è¯¥é€‰æ‹©ç›¸æœºé‚£ç§æ¨¡å¼ï¼Ÿ

æ ¹æ®`camera`çš„æˆåƒåŸç†ï¼Œä¸€å…±æœ‰ä¸¤ç§æ¨¡å¼çš„ç›¸æœºã€‚ä¸€ç§æ˜¯é€è§†æŠ•å½±ï¼Œå®ƒæ˜¯é”¥å½¢çš„æˆåƒæ¨¡å¼ï¼Œæ˜¯ä»æŸä¸ªæŠ•å°„ä¸­å¿ƒå°†ç‰©ä½“æŠ•å°„åˆ°å•ä¸€æŠ•å½±é¢ä¸Šæ‰€å¾—åˆ°çš„é€è§†å›¾ï¼Œæˆåƒæ•ˆæœè¿œå°è¿‘å¤§ï¼Œä¸äººä»¬è§‚çœ‹ç‰©ä½“æ—¶æ‰€äº§ç”Ÿçš„è§†è§‰æ•ˆæœéå¸¸æ¥è¿‘ï¼Œåœ¨åš3Dåœºæ™¯çš„æ—¶å€™ï¼Œå°±å¿…é¡»ç”¨è¯¥æ¨¡å¼æ¥æ‹æ‘„3Dçš„ç”»é¢ã€‚å¦å¤–ä¸€ç§æ˜¯æ­£äº¤æŠ•å½±æ¨¡å¼ï¼Œä¹Ÿå«"å¹³è¡ŒæŠ•å½±"ï¼Œå°±æ˜¯æŠŠå›¾åƒé€šè¿‡å¹³è¡Œå…‰çº¿æŠ•å½±åˆ°ç”»é¢ä¸Šï¼Œå¯ä»¥ç†è§£æˆä¸€å¼ å¹³é¢ä¸Šçš„ç”»ï¼Œå®ƒå°±æ˜¯ç”¨æ¥æ‹æ‘„2Dç”»é¢çš„ã€‚

> å¦‚æœåœºæ™¯å†…æœ‰å¤šä¸ªç›¸æœºï¼Œå¯æ˜¯å±å¹•åªæœ‰ä¸€ä¸ªï¼Œè¿™æ—¶å€™è¿™äº›ç›¸æœºæ˜¯å¦‚ä½•åˆ©ç”¨å±å¹•çš„?

å¼•æ“è¾“å‡ºç”»é¢çš„æ—¶å€™ä¼šæŠŠä¸€ä¸ªâ€”ä¸ªçš„ç›¸æœºçš„å›¾åƒå åŠ èµ·æ¥;

> å¤šä¸ªç›¸æœºçš„æ—¶å€™ï¼Œå¦‚ä½•ç¡®å®šé‚£ä¸ªç›¸æœºå…ˆï¼Œå“ªä¸ªç›¸æœºåå‘¢ï¼Ÿ

ç›¸æœºæœ‰ä¸€ä¸ª`depth`å±æ€§, `depth`å°çš„å…ˆç»˜åˆ¶åˆ°å±å¹•, `depth`å¤§çš„åç»˜åˆ¶åˆ°å±å¹•ã€‚

> æœ‰å¤šä¸ªç›¸æœºï¼Œä½†æ˜¯ç‰©ä½“æ˜¯å”¯ä¸€çš„ï¼›å¤šä¸ªç›¸æœºçš„è¯ï¼Œä¸€ä¸ªç‰©ä½“ä¼šè¢«ç»˜åˆ¶å¤šæ¬¡?

- å¯ä»¥é€šè¿‡åˆç†åˆ†ç»„ç»™æ¯ä¸€ä¸ªç›¸æœºé€‰å–æ‹æ‘„å…·ä½“è¦æ‹æ‘„çš„ç‰©ä½“
- ç›¸æœºä¼šç»˜åˆ¶å±äºè‡ªå·±æ¸²æŸ“åˆ†ç»„é‡Œé¢çš„ç‰©ä½“

> å¦‚ä½•æ¸…é™¤å±å¹•ï¼Ÿ

- ç›¸æœºæœ‰â€”ä¸ª`clearFlag`å¦‚æœä½ è®¾ç½®äº†ï¼Œå®ƒåœ¨ç»˜åˆ¶ç”»é¢çš„æ—¶å€™ï¼Œä¼šæ¸…ç†å±å¹•
- ä¸€èˆ¬åªç»™å‰é¢çš„ç›¸æœºè®¾ç½®`clearFlag`ï¼›åé¢ç›¸æœºéƒ½ä¸èƒ½å†è®¾ç½®ï¼Œä¸ç„¶ä¼šæŠŠå‰é¢ç›¸æœºç»˜åˆ¶çš„å†…å®¹æ¸…é™¤æ‰

æŠŠæ€è·¯æ‹‰å›åˆ°æ”¾å¤§é•œdemoä¸­ï¼Œè¦å®ç°æ”¾å¤§é•œï¼Œå…¶å®å°±æ˜¯å¤šåˆ›é€ ä¸€ä¸ªç›¸æœºå»æ‹æ‘„éœ€è¦æ”¾å¤§çš„ç‰©ä½“ï¼Œç„¶åè°ƒæ•´ç›¸æœºçš„ç¼©æ”¾æ¯”ä¾‹ï¼Œä½¿æŠ•å½±çš„ç‰©ä½“æ”¾å¤§æˆ–è€…ç¼©å°å¯¹åº”çš„å€æ•°ï¼Œç„¶åé…åˆä½¿ç”¨`Mask`ç»„ä»¶å»è£å‰ªæˆ‘ä»¬éœ€è¦çš„å±€éƒ¨ä½ç½®ï¼Œmaskçš„ç¼–è¾‘å™¨è®¾ç½®è¯·å‚è€ƒé¡¹ç›®æºç ï¼Œç›¸æœºåˆå§‹åŒ–ä»£ç å®ç°å¦‚ä¸‹ï¼š

```js
initCamera() {
  let visibleRect = cc.view.getVisibleSize();

  let texture = new cc.RenderTexture();
  texture.initWithSize(visibleRect.width, visibleRect.height);
  let spriteFrame = new cc.SpriteFrame();
  spriteFrame.setTexture(texture);
  this.mirrorCameraNode.getComponent(cc.Camera).targetTexture = texture;

  this.tempCameraSpriteNode.getComponent(cc.Sprite).spriteFrame = spriteFrame;
  this.tempCameraSpriteNode.scaleY = -1;
}
```

## æ•ˆæœé¢„è§ˆ

æºç è·å–è¯·ç‚¹å‡»**æŸ¥çœ‹åŸæ–‡**ï¼Œé•¿æŒ‰äºŒç»´ç æŸ¥çœ‹æ•ˆæœğŸ‘‡

![ewm](./resources/preview_ewm.png)




